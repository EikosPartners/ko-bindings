{"version":3,"sources":["../src/tokeninput.js"],"names":[],"mappings":";;AAAA;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;;;AAEI,mBAAG,eAAH,CAAmB,gBAAnB,GAAsC;AAClC,UAAM,cACF,OADE,EAEF,aAFE,EAGF,WAHE,EAIJ;AACE,YAAI,SAAS,eAAb;AAAA,YACI,WAAW,aADf;AAAA,YAEI,mBAAmB,sBAAE,OAAF,CAFvB;AAAA,YAGI,QAAQ,SAAS,eAAT,IAA4B,mBAAG,UAAH,EAHxC;AAAA,YAII,qBAAqB,KAJzB;AAAA,YAKI,SAAS,KALb;;AAOA,iBAAS,UAAT,GAAsB;AAClB,mBAAO,oBAAM;AACT,uBAAO,OADE;AAET,0BAAU,QAFD;AAGT,uBAAO,KAHE;AAIT,0BAAU,QAJD;AAKT,mCAAmB,IALV;AAMT,0BAAU,CAND;AAOT,yBAAS,KAPA;AAQT,6BAAa,CARJ;AAST,iCAAiB,KATR;AAUT,6BAAa,IAVJ;AAWT,+BAAe,IAXN;AAYT,+BAAe,IAZN;AAaT,0BAAU,mBAAG,MAAH,CAAU,SAAS,iBAAnB,CAbD;AAcT,6BAAa,OAAO,MAAP,CAAc,UAAU,MAAV,EAAkB;AACzC,2BAAO,CAAC,WAAW,EAAZ,EAAgB,QAAhB,CAAyB,OAAO,EAAhC,CAAP;AACH,iBAFY;AAdJ,aAAN,EAiBJ,SAAS,iBAjBL,CAAP;AAkBH;;AAED,iBAAS,QAAT,CAAkB,OAAlB,EAA2B;AACvB;AACA,mBAAO,QAAQ,MAAR,CAAe,UAAU,MAAV,EAAkB;AACpC,uBAAO,CAAC,QAAQ,QAAR,CAAiB,OAAO,EAAxB,CAAR;AACH,aAFM,CAAP;AAGH;;AAED,iBAAS,KAAT,CAAe,KAAf,EAAsB;AAClB;AACA,iCAAqB,IAArB;AACA,kBAAM,IAAN,CAAW,MAAM,EAAjB;AACA,iCAAqB,KAArB;AACH;;AAED,iBAAS,QAAT,CAAkB,OAAlB,EAA2B;AACvB;AACA,gBAAI,MAAJ,EAAY;AACR;AACH;AACD,iCAAqB,IAArB;AACA,kBAAM,MAAN,CAAa,QAAQ,EAArB;AACA,iCAAqB,KAArB;AACH;;AAED,iBAAS,IAAT,GAAgB;AACZ,6BAAiB,UAAjB,CAA4B,MAA5B,EAAoC,YAApC;AACH;;AAED;;AAEA,cAAM,SAAN,CAAgB,YAAW;AACvB,gBAAG,CAAC,kBAAJ,EAAwB;AACpB,yBAAS,IAAT;AACA,iCAAiB,UAAjB,CAA4B,SAA5B;AACA;AACA,yBAAS,KAAT;AACH;AACJ,SAPD;;AASA;AACA;AACA;AACH,KA5EiC;AA6ElC,YAAQ,gBACJ,OADI,EAEJ,aAFI,EAGJ,WAHI,EAIN;AACE,YAAI,SAAS,eAAb;AACA;AACA,8BAAE,OAAF,EAAW,IAAX,CAAgB,UAAhB,EAA4B,UAA5B,GAAyC,MAAzC;AACH;AArFiC,CAAtC;;AAwFA,mBAAG,eAAH,CAAmB,iBAAnB,GAAuC;AACnC,YAAQ,gBACJ,OADI,EAEJ,aAFI,EAGN;AACE,YAAI,aAAa,eAAjB;;AAEA,8BAAE,OAAF,EAAW,UAAX,CAAsB,gBAAtB,EAAwC,mBAAG,MAAH,CAAU,UAAV,CAAxC;AACH;AARkC,CAAvC;;AAWA,mBAAG,eAAH,CAAmB,iBAAnB,GAAuC,EAAvC","file":"tokeninput.js","sourcesContent":["import { merge } from 'scalejs';\r\nimport $ from 'jquery';\r\nimport ko from 'knockout';\r\nimport _ from 'lodash';\r\nimport 'jquery-tokeninput';\r\nimport 'jquery-tokeninput/styles/token-input.css';\r\n\r\n    ko.bindingHandlers.tokeninputSource = {\r\n        init: function(\r\n            element,\r\n            valueAccessor,\r\n            allBindings\r\n        ) {\r\n            var params = valueAccessor(),\r\n                bindings = allBindings(),\r\n                $selectedElement = $(element),\r\n                value = bindings.tokeninputValue || ko.observable(),\r\n                tokeninputUpdating = false,\r\n                reinit = false;\r\n            \r\n            function getOptions() {\r\n                return merge({ \r\n                    theme: 'pjson', \r\n                    onResult: onResult,\r\n                    onAdd: onAdd,\r\n                    onDelete: onDelete,\r\n                    preventDuplicates: true,\r\n                    minChars: 0,\r\n                    caching: false,\r\n                    searchDelay: 0,\r\n                    animateDropdown: false,\r\n                    allowTabOut: true,\r\n                    noResultsText: null,\r\n                    searchingText: null,\r\n                    disabled: ko.unwrap(bindings.tokeninputDisable),\r\n                    prePopulate: params.filter(function (result) {\r\n                        return (value() || []).includes(result.id);\r\n                    }),\r\n                }, bindings.tokenInputOptions)\r\n            }\r\n            \r\n            function onResult(results) {\r\n                //console.log('Results -->', results);\r\n                return results.filter(function (result) {\r\n                    return !value().includes(result.id);\r\n                });\r\n            }\r\n\r\n            function onAdd(added) {\r\n                //console.log('Add -->', added);\r\n                tokeninputUpdating = true;\r\n                value.push(added.id);\r\n                tokeninputUpdating = false;\r\n            }\r\n\r\n            function onDelete(deleted) {\r\n                //console.log('Delete -->', deleted);\r\n                if (reinit) {\r\n                    return;\r\n                }\r\n                tokeninputUpdating = true;\r\n                value.remove(deleted.id);\r\n                tokeninputUpdating = false;\r\n            }\r\n\r\n            function init() {\r\n                $selectedElement.tokenInput(params, getOptions());\r\n            }\r\n\r\n            init();\r\n\r\n            value.subscribe(function() {\r\n                if(!tokeninputUpdating) {\r\n                    reinit = true;\r\n                    $selectedElement.tokenInput('destroy');\r\n                    init();\r\n                    reinit = false;\r\n                }\r\n            })\r\n            \r\n            // if (options.placeholder) {\r\n            //     $selectedElement.parent().find('input').attr('placeholder', options.placeholder);\r\n            // }\r\n        },\r\n        update: function(\r\n            element,\r\n            valueAccessor,\r\n            allBindings\r\n        ) {\r\n            var params = valueAccessor();\r\n            //console.log('new params-->', params);\r\n            $(element).data('settings').local_data = params;\r\n        }\r\n    }\r\n    \r\n    ko.bindingHandlers.tokeninputDisable = {\r\n        update: function (\r\n            element,\r\n            valueAccessor\r\n        ) {\r\n            let isDisabled = valueAccessor();\r\n\r\n            $(element).tokenInput('toggleDisabled', ko.unwrap(isDisabled));\r\n        }\r\n    };\r\n\r\n    ko.bindingHandlers.tokeninputOptions = {};\r\n"]}